language: php

notifications:
  email:
    on_success: never
    on_failure: change
    
php:
  - 5.6

env:
  - WP_VERSION=latest WP_MULTISITE=0

before_script:
  - npm install -g gulp-cli
  - yarn install
  - composer install -o --no-dev
  - bash bin/install-wp-tests.sh wordpress_test root '' localhost $WP_VERSION
  - gulp

script:
  - find . -name composer -prune -o -name node_modules -prune -o -name '*.php' -exec php -lf {} \; > /dev/null
  - phpunit --debug

deploy:
  - provider: releases
    api_key: "${GITHUB_TOKEN}"
    file: "boldgrid-inspirations.zip"
    skip_cleanup: true
    on:
      tags: true
